-- D·ªãch v·ª• c·∫ßn thi·∫øt
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer

-- --- C·∫§U H√åNH UI ---
local UI_CONFIG = {
    MainColor = Color3.fromRGB(35, 35, 35), -- M√†u n·ªÅn ch√≠nh
    SecondaryColor = Color3.fromRGB(50, 50, 50), -- M√†u n·ªÅn ph·ª•
    AccentColor = Color3.fromRGB(0, 170, 255), -- M√†u thanh k√©o
    TextColor = Color3.fromRGB(255, 255, 255),
    ToggleOn = Color3.fromRGB(0, 200, 100), -- M√†u n√∫t khi B·∫≠t
    ToggleOff = Color3.fromRGB(200, 50, 50) -- M√†u n√∫t khi T·∫Øt
}

-- --- BI·∫æN TR·∫†NG TH√ÅI ---
local state = {
    speed = { enabled = false, value = 16, sliderMax = 200 }, -- M·∫∑c ƒë·ªãnh speed
    jump = { enabled = false, value = 50, sliderMax = 300 }   -- M·∫∑c ƒë·ªãnh jump
}

-- --- T·∫†O GIAO DI·ªÜN (GUI) ---
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SpeedJumpUI"
-- N·∫øu ch·∫°y trong Studio th√¨ d√πng PlayerGui, n·∫øu exploit th√¨ d√πng CoreGui ƒë·ªÉ kh√¥ng b·ªã reset khi ch·∫øt
if RunService:IsStudio() then
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
else
    -- Th·ª≠ b·∫£o v·ªá GUI (t√πy m√¥i tr∆∞·ªùng)
    pcall(function() ScreenGui.Parent = CoreGui end)
    if not ScreenGui.Parent then ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui") end
end

-- Khung ch√≠nh
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 220, 0, 230)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -115) -- Gi·ªØa m√†n h√¨nh
MainFrame.BackgroundColor3 = UI_CONFIG.MainColor
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

-- Bo tr√≤n g√≥c
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

-- Ti√™u ƒë·ªÅ
local Title = Instance.new("TextLabel")
Title.Text = "CONTROL PANEL"
Title.Size = UDim2.new(1, 0, 0, 30)
Title.BackgroundTransparency = 1
Title.TextColor3 = UI_CONFIG.TextColor
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18
Title.Parent = MainFrame

-- --- H√ÄM CH·ª®C NƒÇNG K√âO TH·∫¢ (DRAGGABLE) ---
local function makeDraggable(frame)
    local dragging, dragInput, dragStart, startPos
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)
    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end
makeDraggable(MainFrame)

-- --- H√ÄM T·∫†O THANH K√âO (SLIDER) ---
local function createControl(name, yPos, typeStr)
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(0.9, 0, 0, 80)
    Container.Position = UDim2.new(0.05, 0, 0, yPos)
    Container.BackgroundColor3 = UI_CONFIG.SecondaryColor
    Container.BorderSizePixel = 0
    Container.Parent = MainFrame
    Instance.new("UICorner", Container).CornerRadius = UDim.new(0, 6)

    -- T√™n ch·ª©c nƒÉng
    local Label = Instance.new("TextLabel")
    Label.Text = name
    Label.Size = UDim2.new(1, -60, 0, 30)
    Label.Position = UDim2.new(0, 10, 0, 0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = UI_CONFIG.TextColor
    Label.Font = Enum.Font.SourceSansSemibold
    Label.TextSize = 16
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container

    -- N√∫t B·∫≠t/T·∫Øt
    local ToggleBtn = Instance.new("TextButton")
    ToggleBtn.Size = UDim2.new(0, 40, 0, 20)
    ToggleBtn.Position = UDim2.new(1, -50, 0, 5)
    ToggleBtn.BackgroundColor3 = UI_CONFIG.ToggleOff
    ToggleBtn.Text = "OFF"
    ToggleBtn.TextColor3 = Color3.new(1,1,1)
    ToggleBtn.Font = Enum.Font.SourceSansBold
    ToggleBtn.Parent = Container
    Instance.new("UICorner", ToggleBtn).CornerRadius = UDim.new(0, 4)

    -- Thanh tr∆∞·ª£t (Background)
    local SliderBg = Instance.new("TextButton") -- D√πng button ƒë·ªÉ b·∫Øt s·ª± ki·ªán click d·ªÖ h∆°n
    SliderBg.Text = ""
    SliderBg.Size = UDim2.new(0.9, 0, 0, 10)
    SliderBg.Position = UDim2.new(0.05, 0, 0, 45)
    SliderBg.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    SliderBg.AutoButtonColor = false
    SliderBg.Parent = Container
    Instance.new("UICorner", SliderBg).CornerRadius = UDim.new(1, 0)

    -- Thanh tr∆∞·ª£t (Fill)
    local SliderFill = Instance.new("Frame")
    SliderFill.Size = UDim2.new(0, 0, 1, 0) -- B·∫Øt ƒë·∫ßu b·∫±ng 0
    SliderFill.BackgroundColor3 = UI_CONFIG.AccentColor
    SliderFill.BorderSizePixel = 0
    SliderFill.Parent = SliderBg
    Instance.new("UICorner", SliderFill).CornerRadius = UDim.new(1, 0)

    -- Hi·ªÉn th·ªã s·ªë
    local ValueLabel = Instance.new("TextLabel")
    ValueLabel.Text = "Value: 0"
    ValueLabel.Size = UDim2.new(1, 0, 0, 20)
    ValueLabel.Position = UDim2.new(0, 0, 0, 60)
    ValueLabel.BackgroundTransparency = 1
    ValueLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    ValueLabel.TextSize = 14
    ValueLabel.Parent = Container

    -- --- LOGIC ---
    local currentData = state[typeStr]
    
    -- Logic N√∫t B·∫≠t/T·∫Øt
    ToggleBtn.MouseButton1Click:Connect(function()
        currentData.enabled = not currentData.enabled
        if currentData.enabled then
            ToggleBtn.Text = "ON"
            ToggleBtn.BackgroundColor3 = UI_CONFIG.ToggleOn
        else
            ToggleBtn.Text = "OFF"
            ToggleBtn.BackgroundColor3 = UI_CONFIG.ToggleOff
            -- Reset v·ªÅ m·∫∑c ƒë·ªãnh khi t·∫Øt
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                if typeStr == "speed" then char.Humanoid.WalkSpeed = 16 end
                if typeStr == "jump" then char.Humanoid.JumpPower = 50 end
            end
        end
    end)

    -- Logic Thanh K√©o
    local mouse = LocalPlayer:GetMouse()
    local draggingSlider = false

    local function updateSlider()
        local percent = math.clamp((mouse.X - SliderBg.AbsolutePosition.X) / SliderBg.AbsoluteSize.X, 0, 1)
        SliderFill.Size = UDim2.new(percent, 0, 1, 0)
        
        local newValue = math.floor(percent * currentData.sliderMax)
        currentData.value = newValue
        ValueLabel.Text = "Value: " .. newValue
    end

    SliderBg.MouseButton1Down:Connect(function()
        draggingSlider = true
        updateSlider()
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            draggingSlider = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if draggingSlider and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateSlider()
        end
    end)
end

-- T·∫°o 2 b·ªô ƒëi·ªÅu khi·ªÉn
createControl("T·ªëc ƒê·ªô Ch·∫°y", 40, "speed")
createControl("ƒê·ªô Nh·∫£y Cao", 130, "jump")

-- --- V√íNG L·∫∂P √ÅP D·ª§NG CH·ªà S·ªê ---
-- D√πng RenderStepped ƒë·ªÉ li√™n t·ª•c set gi√° tr·ªã n·∫øu ƒëang B·∫≠t
RunService.RenderStepped:Connect(function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then
        -- X·ª≠ l√Ω T·ªëc ƒë·ªô
        if state.speed.enabled then
            char.Humanoid.WalkSpeed = state.speed.value
        end
        
        -- X·ª≠ l√Ω Nh·∫£y
        if state.jump.enabled then
            char.Humanoid.UseJumpPower = true -- B·∫Øt bu·ªôc d√πng JumpPower thay v√¨ JumpHeight
            char.Humanoid.JumpPower = state.jump.value
        end
    end
end)


--[[ üü¢ BUTTON TOGGLE UI (N√∫t b·∫≠t t·∫Øt menu) ]]
-- X√≥a GUI c≈© n·∫øu t·ªìn t·∫°i ƒë·ªÉ tr√°nh tr√πng l·∫∑p khi execute l·∫°i
if game.CoreGui:FindFirstChild("BearHubToggleButton") then
    game.CoreGui.BearHubToggleButton:Destroy()
end

local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("ImageButton")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke") -- [M·ªöI] Th√™m vi·ªÅn

ScreenGui.Name = "BearHubToggleButton"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ToggleButton.BorderSizePixel = 0
ToggleButton.Position = UDim2.new(0.12, 0, 0.15, 0)
ToggleButton.Size = UDim2.new(0, 45, 0, 45) -- TƒÉng k√≠ch th∆∞·ªõc ch√∫t cho d·ªÖ b·∫•m
ToggleButton.Image = "rbxassetid://125701776396252" 
ToggleButton.Draggable = true

UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = ToggleButton

-- [M·ªöI] C·∫•u h√¨nh vi·ªÅn ban ƒë·∫ßu
UIStroke.Parent = ToggleButton
UIStroke.Thickness = 2
UIStroke.Color = Color3.fromRGB(255, 255, 255)
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

ToggleButton.MouseButton1Click:Connect(function()
    if Window then 
        Window:Minimize()
    end
end)

-- [M·ªöI] LOGIC RAINBOW (C·∫¶U V·ªíNG)
local RunService = game:GetService("RunService")
local RainbowConfig = {
    Enabled = false,
    Speed = 1
}

RunService.RenderStepped:Connect(function()
    if ToggleButton and UIStroke and RainbowConfig.Enabled then
        local hue = tick() * RainbowConfig.Speed % 1
        UIStroke.Color = Color3.fromHSV(hue, 1, 1)
    end
end)

print("UI Loaded Successfully!")
